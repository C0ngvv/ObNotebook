
# 翻译
## 摘要
近年来，基于物联网(IoT)的网络攻击越来越多。正如预期的那样，这些攻击是通过利用已知的安全漏洞从受损的物联网设备发起的。然而，物联网设备漏洞普遍存在的根本原因及其安全影响尚不清楚，特别是它们如何影响正在进行的网络犯罪。为了更好地了解问题并寻求有效的手段来抑制基于物联网的攻击浪潮，我们基于从蜜罐收集的大量真实攻击痕迹，从地下购买的攻击工具以及从高调物联网攻击中收集的信息进行了全面研究。这项研究揭示了当今物联网系统的设备漏洞及其安全影响:持续的网络攻击严重依赖于这些已知漏洞和通过报告发布的攻击代码;另一方面，这种对已知漏洞的依赖实际上可以用来对付对手。能够以极低的成本开发攻击的bug报告也可以用来提取有助于阻止攻击的特定于漏洞的特性。特别是，我们利用自然语言处理(NLP)来自动收集和分析分布在互联网上的bug报告博客、论坛和邮件列表中的7500多份安全报告(总共有12286个安全关键的物联网漏洞)。我们展示了签名可以通过基于nlp的报告分析自动生成，并被入侵检测或防火墙系统使用，以有效减轻当今基于物联网的攻击的威胁。

## 1.引言
物联网(IoT)系统的普及，从摄像头、路由器、打印机到各种家庭自动化、工业控制和医疗系统，也带来了新的安全挑战:它们比传统的计算系统更容易受到攻击。一旦物联网系统的漏洞暴露出来，它们可能会落入对手的手中。事实上，近年来出现了一波备受瞩目的物联网相关网络攻击，其中最突出的例子包括IoT Reaper[25]、Hajime[24]和Mirai[41]。特别是，受损的物联网系统正在成为当今僵尸网络的支柱，在最近的分布式拒绝服务攻击和其他网络犯罪中发挥着核心作用[39]。例如，Mirai涉及数十万个物联网设备，并产生了600 Gbps的攻击量，超过了安全、OVH和Dyn上的Krebs。据报道，这些设备都是通过已知漏洞被黑客攻击的，包括由配置错误或管理不善引起的漏洞，就像未打补丁的服务器和个人电脑一样，经常被利用[42]。然而，这种恶意活动趋势的根本原因仍然不太清楚，这些恶意活动与物联网系统以及这些易受攻击的设备对网络犯罪生态系统的影响不成比例地相关。

**了解危险的物联网世界**。更具体地说，我们提出了以下问题:为什么物联网设备比其他互联网主机更有利于网络犯罪分子?已知漏洞对物联网系统的持续攻击有多重要?是否有有效的防御来减轻持续的攻击?这些问题的答案对于寻求有效的手段来阻止越来越依赖于大量易受攻击的物联网设备的恶意攻击浪潮至关重要。然而，找到这些答案绝非易事，因为面临以下挑战:(1)从散布在论坛、邮件列表和博客上的大量漏洞报告中恢复已披露的物联网漏洞，以及(2)从地下网络犯罪中收集工件，以研究如何利用已知漏洞以及它们对正在进行的犯罪活动有多重要。

为了了解网络犯罪分子如何利用这些已知漏洞，我们设置了蜜罐来收集现实世界物联网漏洞的数据，并分析了四种流行的攻击工具包。从对手的角度来看，我们的研究表明，当今的物联网攻击几乎完全利用已知漏洞进行利用。具体来说，在我们从蜜罐中恢复的81个不同的漏洞利用脚本中，我们发现其中78个在我们的漏洞列表中。此外，我们研究的四个攻击工具包中的每一个都包含了对至少34个漏洞的利用，它们都在我们的列表中。更重要的是，我们证明了攻击者广泛地利用了与漏洞报告一起发布的漏洞代码，并且在大多数情况下，直接复制代码或稍微调整代码。超过80%的物联网相关报告都有有效的攻击方法。根据我们的观察，大多数物联网漏洞都可以被利用来攻击目标设备(相比之下，Linux内核漏洞中只有5%的漏洞可被利用[43])，很明显，今天攻击物联网系统的成本非常低。

**自动保护生成**。另一方面，我们表明对手对这些唾手可得的果实的放纵实际上可以用来对付他们自己。具体来说，对已知漏洞的依赖意味着一旦这些问题得到修复，就会关闭一个大的攻击面。有趣的是，这被证明是完全可行的，因为问题很简单，漏洞披露和攻击代码的可用性包含了修复报告缺陷所需的所有信息。基于这一观察，我们开发了一个名为IoTShield的框架，它利用自然语言处理(NLP)来自动评估漏洞报告的内容。特别是，IoTShield基于一套自动内容分析技术，可以从不同来源发布的大量漏洞报告中准确发现物联网相关漏洞

使用上述方法，我们自动分析了43万份漏洞报告，并在过去20年中发现了7500多份物联网报告。然后，IoTShield从这些报告中提取关键知识，自动生成针对漏洞的签名，这些签名可以被现有的入侵检测系统(ids)或web应用防火墙(waf)使用，以筛选受保护的物联网设备接收的流量。我们验证了IoTShield的有效性，超过了我们蜜罐收集的178,778条痕迹，以及8个真实设备的11,602条痕迹，包括攻击和合法流量。此外，我们评估了IoTShield在工业控制系统人机界面(HMI)蜜罐中捕获的长时间(超过一年)流量的有效性。评估结果表明，IoTShield实现了高精度(97%以上)和非常低的假阳性率，性能影响很小。

**贡献**。这项工作的主要贡献概述如下:
- 新发现。利用收集到的真实世界物联网漏洞的痕迹和流行攻击工具包的分析结果，我们揭示了新的观察结果，包括对手专门使用已知缺陷和已发布的代码。这些观察结果表明，物联网设备确实比传统的互联网主机更容易受到攻击，更不容易修补，也更容易受到攻击，这说明了严重依赖这些设备的持续网络犯罪趋势。
- 新的防御。更重要的是，这些发现还为我们提供了一个机会，可以立即挫败当今物联网相关攻击中的大多数攻击媒介。我们展示了攻击者用来构建漏洞的相同来源，可以使用NLP自动生成漏洞签名，并快速部署以保护物联网设备免受恶意攻击。鉴于对手对这些已知漏洞的依赖，我们相信这种简单、低成本但有效的防御将大大提高未来物联网相关攻击的门槛。

路线图。本文的其余部分组织如下。第2节介绍了背景和我们的威胁模型。第3节描述了我们对物联网漏洞和物联网设备面临的现实威胁的新理解。第4节介绍了防御物联网攻击的自动防护生成。第5节和第6节分别介绍了我们的自动保护生成的实现和评估。第7节讨论了本研究的局限性和缓解措施。第8部分概述了相关工作，最后，第9部分对本文进行了总结。

## 2.背景
**物联网漏洞生命周期**。通常，物联网设备的漏洞是其固件中的漏洞，使攻击者能够绕过部署的安全措施[57]。这种漏洞的生命周期具有不同的阶段，其特征是发现、披露、利用和修补。当漏洞被供应商、黑客或第三方安全研究人员发现时，第一阶段就开始了。如果首先被黑客发现，安全风险会变得特别高。下一阶段是由发现漏洞的人公开披露漏洞，应该通过一个协调的过程[22]来完成，在这个过程中，漏洞信息是保密的，允许供应商创建补丁。然而，这一程序并不总是被遵循。真实世界中的信息披露可能以不同的方式通过Internet上的来源发生，包括个人博客、公共论坛和安全邮件列表。一旦公开披露，有关漏洞的信息对任何人都是免费的。因此，随着黑客社区积极开发和发布零日漏洞，安全风险水平进一步提高[40]。根据我们的观察，大约80%的物联网漏洞报告是与可利用方法一起发布的，这些方法很容易被黑客利用。

更糟糕的是，供应商可能不提供任何安全更新或补丁来响应泄露，即使它应该这样做。此外，即使有补丁可用，受影响的物联网设备的许多用户也不会安装它们，因为修补固件的过程很复杂(对于普通用户)。

物联网漏洞的生命周期在所有物联网用户安装补丁以修复漏洞时结束。然而，即使物联网设备存在严重的安全漏洞，并且供应商已经发布了补丁，但由于一些用户的知识有限，无法及时更新补丁。根据我们的观察，一些物联网漏洞的生命周期长达五年以上，在此期间，这些问题随时可能被利用。

**基于签名的IDS**。入侵检测系统(IDS)监视网络或系统的恶意活动或策略违反。这些系统可以基于签名，也可以基于异常。基于签名的检测利用恶意代码或操作的已知模式(签名)来识别恶意活动，而基于异常的检测则捕获与系统正常配置文件的偏差。我们保护的重点是为基于签名的检测系统(如Snort[37])提供自动签名生成。

签名可用于描述针对漏洞的特定攻击或对漏洞本身进行建模。后者提供了针对弱点的所有相关攻击的全面保护，称为特定于漏洞的签名。这样的签名通常是通过手工分析漏洞创建的。然而，在我们的研究中，我们发现来自各种来源(博客、邮件列表和论坛)的关于物联网漏洞的丰富信息实际上可以利用NLP技术自动生成这样的签名。

**自然语言处理**。我们的研究利用各种NLP技术来分析各种漏洞报告的文本内容。拼写检查[1]用于过滤与IoT无关的文档。基于正则表达式的模式匹配，识别物联网相关漏洞报告。此外，使用语义一致性分析来检查提取的物联网实体。为了生成特定于漏洞的签名，需要深入了解漏洞语义，这可以通过使用语法依赖解析器来实现[51]，语法依赖解析器提供了句子中单词之间语法关系的表示。

**威胁模型**。在这项工作中，我们考虑了一个试图利用漏洞报告中披露的安全漏洞来破坏远程互联网连接的物联网设备的对手。为此，攻击者可以破坏远程物联网设备并利用它们发动恶意攻击。我们特别关注互联网连接的物联网设备(例如，IP摄像机，路由器和打印机)，这些设备在互联网上暴露了它们的攻击面。因此，攻击者可以远程利用这些设备的安全漏洞，并获得对这些易受攻击设备的未经授权的控制(例如，受损的物联网设备可能成为僵尸网络节点)。

## 3.了解现实世界的威胁
为了了解攻击者如何利用物联网漏洞，我们部署了蜜罐，分析了地下攻击工具包，并研究了之前的攻击报告。在这里，我们详细阐述我们的发现。

## 4.特定于漏洞的自动签名生成
如前所述，物联网漏洞生态系统存在一个严重的问题:攻击脚本通常在漏洞报告中公开可用，使得这些已知漏洞很容易被利用。这个问题导致了近年来大规模物联网攻击的狂潮，这些攻击几乎完全利用了已知的漏洞。

与此同时，攻击者对充分记录的漏洞的依赖也为减轻此类威胁提供了新的机会。从同一份漏洞报告中，可以提取针对漏洞的信息，形成针对该漏洞的保护策略，阻止针对该漏洞的所有攻击。在我们的研究中，我们开发了IoTShield，这是一个自动收集来自互联网的物联网漏洞报告的工具，分析物联网漏洞报告的内容，并恢复关键知识以生成针对漏洞的签名，其质量取决于报告的全面性。这些签名可以很容易地部署到现有的入侵检测系统(ids)或web应用防火墙(waf)中，从目标设备接收到的流量中检测对目标设备的攻击企图。下面，我们将详细说明这种方法。

### 4.1 概述和数据
从互联网上收集物联网漏洞报告，并从收集到的物联网漏洞报告中提取针对漏洞的知识用于签名生成是一项艰巨的任务，具有独特的技术挑战。首先，大量的漏洞报告散布在论坛、邮件列表和博客上，由不同的人撰写，格式不同。很难从其他文档中识别物联网漏洞报告。其次，此类识别物联网漏洞报告以自然语言描述安全漏洞，使得漏洞信息的大规模发现变得困难。第三，识别签名的关键元素需要特定于领域的知识，以仔细区分特定于利用程序的信息和特定于漏洞的信息。为了应对这些挑战，在IoTShield中，我们使用物联网漏洞提取器来删除不相关的内容并识别物联网安全漏洞的关键信息。在收集物联网漏洞报告后，我们从漏洞报告中提取漏洞描述的语义和其他结构化信息(如攻击脚本)。这里的描述提供了有关漏洞可以被利用的所有情况的信息(例如，所有相关参数和位置)，这使我们能够利用从攻击脚本中观察到的攻击面或其他结构化信息(如流量日志)来阻止其他攻击。一个问题是，一些漏洞报告没有漏洞描述或结构化信息。稍后我们将讨论如何处理这个问题(参见第4.3节)。

**架构**。图2展示了IoTShield的架构，它有三个主要组成部分:(1)数据收集，(2)物联网漏洞提取，(3)自动生成保护。数据收集用于从Internet上收集漏洞报告。物联网漏洞提取是指从论坛、博客、邮件列表等大量文档中提取物联网漏洞信息。更具体地说，我们爬取流行的在线资源来披露漏洞，并进一步运行语料库质量分析器来过滤掉与漏洞报告无关的文档。对于剩余的文档，我们使用识别器来识别物联网漏洞报告并提取关键信息，例如它们的类型，受影响的产品，CVE编号，作者和发布日期。此信息将作为后续签名生成阶段的描述。一旦给定一组物联网漏洞报告，IoTShield首先将描述同一漏洞的报告聚集在一起，然后利用NLP从描述中发现漏洞语义(例如漏洞类型，漏洞位置和参数)。然后，它提取结构化信息(例如，流量日志、脚本和Linux命令)来创建一个漏洞(或PoC)模板，并找到非法参数(例如，用于注入命令的参数)。之后，签名生成组件利用漏洞位置和参数来识别所有相关的攻击面，从而确定模板中所有可能导致漏洞利用的参数。这里的参数和模板组成了签名。最后，IoTShield自动将签名转换为现有IDS或WAF中使用的格式(我们研究中构建的原型输出Snort签名[37])，以便快速部署。

![](images/Pasted%20image%2020230627202636.png)

**数据集**。如前所述，我们在表6中列出的漏洞报告网站上运行我们的爬虫，包括论坛(seclist.org/fulldisclosure)、邮件列表(seclist.org/bugtraq)、个人博客/咨询(pierrekim.github.io)、研究团队咨询(coresecurity.com)和漏洞存档网站(packetstromsecurity.com)。这些来源是从cve中包含的外部参考文献中收集的，其中我们选择了最常用的来源。从这些来源中，我们进一步手动挑选出与物联网漏洞相关的内容，如seclist.org，并将其添加到列表中，该列表还包括一些已知报告安全漏洞的研究小组的网站。

![](images/Pasted%20image%2020230627202915.png)

### 4.2 物联网漏洞提取
**预处理**。在爬虫收集到的文档中，我们的物联网漏洞提取组件删除了与漏洞无关的文本信息，如广告、图片、动态脚本、导航栏等，同时保留了每个网页的主要内容，包括文档url、文档标题、作者和发布日期。由于不同的网站有不同的模板和HTML结构，我们手动分析每个网站(共13个漏洞报告网站，见表6)，以识别有用的内容。

**语料库质量分析仪**。预处理后，我们仍然需要过滤掉与IoT漏洞报告无关的文档，具体操作如下:
- 字典中单词的百分比。我们删除了内容中大部分(在我们的研究中超过82%)是由enchant库识别的字典单词的文档[1]，因为一个真正的漏洞报告总是包含大量的非文本信息，如漏洞路径和函数、PoC或脚本等。否则，文本看起来更像是一篇调查文章、白皮书或通知。
- 超链接的数量。一般来说，一个漏洞报告，特别是物联网，不应该包含太多的超链接。否则，它可能是所披露的所有漏洞的摘要，而不是包含详细漏洞信息的特定报告。因此，我们丢弃了具有超过25个超链接的文档。
- 阈值的理由。上述两个阈值(即82%和25)是基于我们的经验，保证所有非物联网漏洞报告被过滤掉。为了进一步证明我们的阈值配置是合理的，我们试图估计一个真实的物联网漏洞报告被错误丢弃的可能性。为此，我们随机抽取100份被丢弃的文档，然后手工检查是否存在错误丢弃的情况(即真实的物联网漏洞报告，但作为非物联网丢弃)。我们发现，所有样本文档都与物联网漏洞报告无关(既不涉及物联网漏洞，也不包含任何漏洞细节)。换句话说，在这100个随机抽样的被丢弃为非物联网的文档中，没有一个真实的物联网案例被错误地丢弃为非物联网。这意味着我们的经验阈值配置非常有效地过滤掉非物联网漏洞报告。

**物联网漏洞识别**。对于剩余的文档，我们进一步运行识别器来发现物联网漏洞报告并提取关键信息(即设备类型，供应商名称和漏洞类型)。将漏洞信息的检索建模为自然语言处理中的命名实体识别问题[52]。更具体地说，我们首先尝试识别四种与物联网漏洞相关的实体，包括设备类型、供应商、产品名称和漏洞类型，然后利用它们之间的依赖关系来确认存在与漏洞相关的描述。考虑到描述的唯一性，我们采用了一套物联网特定的识别技术来检索它们，如下所述。

为了识别这些单独的实体，我们使用了基于关键字和正则表达式的匹配。对于设备类型、厂商名称、漏洞类型，我们使用了一组关键字，如表7所示:只要找到类别(设备类型、厂商名称、漏洞类型)中的一个词，我们就认为其对应的实体存在。这些关键词来自现实世界设备的特性。具体来说，我们收集了所有常见的设备类型，包括路由器、相机、调制解调器和打印机，并从维基百科中找到了供应商名称。我们还从Common Weakness Enumeration (CWE)中收集了漏洞类型，CWE是社区开发的常见软件安全漏洞列表[9]。此外，我们还将这些漏洞的常见缩写词添加到列表中，例如CSRF和RCE。对于产品名称，我们构建正则表达式来识别每个实体，因为枚举量大且困难。表7列出了这些表达式。

![](images/Pasted%20image%2020230627203447.png)

这样，我们的方法可以识别所有与物联网漏洞相关的文档。然而，鉴于此类实体的普遍性(例如，术语“交换机”也出现在与物联网缺陷无关的文件中)，单独使用它们可能会引入大量误报。为了解决这个问题，我们利用这些实体之间的依赖关系来确保正确识别这些漏洞。

直观地说，当这些实体确实用于描述物联网漏洞时，它们不会独立发生。相反，他们聚在一起提出一个概念。这意味着它们之间存在依赖关系。特别是，供应商实体的术语在产品实体或设备类型实体之前:例如，D-Link DIR-600或Foscam IPcamera。此外，文档还需要包含漏洞类型，例如命令注入。使用这些规则，我们可以将这些实体拼凑在一起，将物联网产品与漏洞联系起来。然而，仍然有一些情况满足上述规则，但不是物联网设备实体，如“NAI NAI-0020”和“EE 13EFF4”。为了抑制误报，我们使用实体检查器进一步调查结果。更具体地说，在实体检查器中，我们在Google中搜索提取的实体(例如D-Link DIR-600)，然后计算提取的实体与搜索结果标题之间的余弦相似度。如果相似度极低(例如0.08)，我们将提取的实体视为非物联网设备。

图3显示了漏洞报告中的物联网漏洞(前四个)和其他漏洞(后三个)的示例。对于预处理阶段提取的每个漏洞，我们使用关键字匹配来识别设备类型(如路由器)、供应商(如Belkin)和漏洞类型(如路径遍历)。然后，我们使用基于正则表达式的匹配来提取产品信息(例如，N150)。之后，我们通过本地依赖和实体检查器检查提取的实体是否组合在一起呈现IoT漏洞概念。例如，三个实体“Belkin”、“router”和“N150”一起描述物联网设备。从图3中可以看出，前四种总是包含受影响的物联网产品(如D-Link DIR-600)和漏洞类型(如命令注入)，而后三种则没有。一旦发现这样的报告，我们的方法进一步从其内容中提取固件版本和CVE编号，当这些信息存在时，用于后续分析。表7中还列出了用于标识这些实体的正则表达式。

![](images/Pasted%20image%2020230627203758.png)

### 4.3 自动生成防御规则
物联网漏洞识别完成后，我们从物联网漏洞报告中识别实体(即设备类型、厂商、产品名称、漏洞类型)。然后，这些实体用于将描述相同物联网漏洞的物联网漏洞报告聚集在一起。然后，给定每个集群，我们从漏洞报告中提取漏洞语义(如漏洞位置2和漏洞利用参数)和其他结构化信息(如攻击脚本)。如图4所示，这个生成过程使我们能够利用攻击面来生成特定于漏洞的签名。

![](images/Pasted%20image%2020230627204127.png)

图5给出了一个示例，展示了我们如何从提取的IoT漏洞报告中生成签名。在图的左上角是漏洞描述。左下角是结构化信息的内容，这是利用此漏洞的流量日志。IoTShield首先定位描述中的漏洞语义。例如，“command injection in PwdGrp.cgi”这句话表明该漏洞类型为“命令注入”，受影响的位置为“PwdGrp.cgi”，以及另一句“用户名、密码和组参数”中的漏洞参数。然后，IoTShield解析结构化信息(如流量日志)，从命令指示符“;”和合法命令列表中发现易受攻击的CGI路径“/CGI -bin/supervisor/PwdGrp.cgi”和命令注入参数“pwd =;reboot;”。

![](images/Pasted%20image%2020230627204100.png)

进一步，从关于其他易受攻击的参数“用户名、密码和组参数”的句子中(从描述中)，我们现在可以推断，同样的注入也可能发生在“usr”和“grp”上，但不会发生在“action”和“lifetime”参数上。通过这种方式，我们可以为注入缺陷构建特定于漏洞的签名，然后将其转换为Snort格式(基于漏洞类型)，如图5所示。在这里，我们详细介绍IoTShield的各个组件。

**报告聚类**。有一些不同的博客描述相同的漏洞，这些报告可能从不同的角度描述漏洞。因此，在规则生成阶段之前，我们需要将这些报告聚集在一起，形成一个完整的漏洞报告。挑战在于，尽管两个报告描述了相同的漏洞，但它们可能具有不同的格式和不同的散列值。我们的解决方案是使用从物联网漏洞报告中识别的实体(即设备类型，供应商，产品名称和漏洞类型)来集群描述相同物联网漏洞的物联网漏洞报告。

注意，报告聚类的目的是补充漏洞报告中缺失的信息(例如，缺失的脚本代码或缺失的漏洞描述)。很少存在设备类型、厂商、产品名称、漏洞类型相同的不同漏洞。然而，即使不同的漏洞聚集在一起，我们也可以在匹配模板时提取每个漏洞的签名(参见4.3节)。

**语义和结构化信息检索**。我们首先利用NLP技术对漏洞描述进行分析，找到漏洞语义，包括漏洞类型、位置和带有漏洞参数的短句。我们的方法是基于观察感兴趣的语义信息是通过一个相对稳定的语法结构来呈现的。具体来说，我们利用4.2节中的漏洞类型列表确定所记录问题的类型，并利用正则表达式找到漏洞位置，漏洞位置应为“.htm”、“.cgi”、“.php”、“.asp”、“.html”等web内容文件。对于漏洞参数，我们的方法定位包含关键字“参数”、“变量”、“动作”、“功能”的句子，并利用这些词与参数值之间的语法关系来找到它们。为此，我们使用Stanford dependency Parser[51]构建了一个依赖树来解析整个句子，然后提取名词作为目标术语，检查它们与关键词的关系。如果这些术语与关键字具有非“nmod”关系3，或者与已标识的参数具有“conj”关系4，则将它们视为参数。图6显示了一个示例。

![](images/Pasted%20image%2020230627204825.png)

此外，我们使用正则表达式(在附录的表13中列出)来定位不同类型的结构化信息，包括使用Linux命令(curl和wget)的PoC、PoC URL、PoC HTML脚本和PoC流量日志等。对于每种类型的结构化信息，我们构建了一个解析器将其转换为通用模板:
```
http://HOST:PORT/file.suffix?{parameters}
```

其中HOST为设备的IP地址，port为应用层服务器端口号(默认为80)，file.suffix是漏洞的位置，{parameters}是键值格式，其中包含了漏洞文件中使用的参数。对于{parameters}中的每一项，IoTShield都会检查它是否携带非法的值，比如注入的Linux命令或Java脚本。请注意，并非所有漏洞都需要参数，例如一些信息披露漏洞，这些漏洞可以通过简单地请求漏洞位置来利用。通过这种方式，我们的方法从漏洞报告中获取语义和结构化信息。

**签名生成**。在从报告中发现漏洞信息后，IoTShield利用它来构建签名。具体来说，我们首先比较了漏洞位置(从描述中恢复)和模板中的“file.suffix”(来自结构化信息);如果匹配，我们认为语义信息(包括漏洞类型和参数)是关于模板建模的漏洞(例如脚本攻击的漏洞)。然后，根据漏洞类型，我们决定是否忽略模板的参数部分，因为有些漏洞不需要参数来利用(如信息泄露、目录遍历)。对于不需要参数利用的漏洞类型(例如D-Link路由器[CVE-2018-10822]中的目录遍历(" /…/…/etc/passwd ")，我们忽略了参数部分。在我们的数据中所有的漏洞类型中，信息泄露和目录遍历是仅有的两种不需要参数就可以利用的典型漏洞类型。对于那些需要参数的漏洞，IoTShield将模板中的参数字段泛化为从描述中收集的参数字段。通过这种方式，我们构建了一个特定于漏洞的签名。图5显示了一个示例。

![](images/Pasted%20image%2020230627204100.png)

这个简单签名生成过程的一个问题是，语义信息和结构化信息可能并不总是以精确的方式匹配。例如，在图5中，漏洞描述中的漏洞参数以自然语言(即用户名、密码和组)表示，而在结构化信息(即user、pwd和grp)中进行了缩写。为了解决这个问题，我们手动收集了一个列表，将各个关键字映射到Linux中使用的相应缩写，例如grp表示group，以便将自然语言术语转换为签名中的参数。

另一个问题是，如前所述，一些漏洞报告不包含漏洞描述和结构化信息;或者漏洞描述不包含所有漏洞语义。接下来，我们讨论如何处理它们。
- 仅提供漏洞描述。如果没有结构化的信息，我们所能得到的只是漏洞类型、位置和参数。然而，这些参数可能不太可靠，因为它们可能有缩写，我们看不到。因此，我们只能为某些漏洞生成签名:其中仅知道漏洞位置(例如“PwdGrp.cgi”)就足以进行保护的漏洞。此类缺陷的例子包括信息泄露和目录遍历，例如，对于信息泄露问题，对/QIS_wizard.htm的请求就足以生成签名。
- 只有结构化信息。没有漏洞描述，我们就不能生成一个通用的、特定于漏洞的签名。但是，我们仍然可以利用结构化信息来构建特定于利用的签名，以击败漏洞报告中描述的攻击脚本。正如我们在测量研究(第3节)中发现的那样，当今的物联网攻击经常使用这些已发布的脚本。这些签名仍然有助于检测许多正在进行的攻击，尽管一旦攻击者愿意付出更多努力来更好地理解他所攻击的缺陷，它们就可以被规避。重要的是要注意，这里仍然有可能进行某种程度的概括;例如，一旦从攻击脚本中恢复的参数中发现包含Linux命令，我们可以将攻击中常用的其他命令添加到参数列表中以生成签名。

## 5.实现与部署
###  5.1 实现
我们实现了一个IoTShield的原型系统，其中包括一组构建模块。在这里，我们简要地描述了系统的螺母和螺栓，然后展示了他们是如何组装到原型系统。

**螺母和螺栓**。我们的原型系统建立在三个关键的功能组件之上:报告爬虫、漏洞提取器和规则生成器。这些组件在整个系统中广泛使用，它们的实现如下。

- 报告爬虫使用wget和scrapy爬虫框架从互联网上获取漏洞报告[36]。具体来说，对于一些存档良好的网站(例如seclists.org/fulldisclosure)，我们使用“wget -mirror”来递归地下载它们的页面(即，尽可能深入地抓取网站)。对于其他网站，我们使用scrapy抓取框架来抓取整个网站。由于网站有时有爬行限制(例如，packketstorm.com有速率限制，s3cur1ty.de需要在每个请求的头中提供cookie)，我们的爬行器模拟浏览器行为以减轻这些限制。它为每个请求使用不同的用户代理，并在发送多个请求后随机休眠一段时间;此外，一旦访问失败，在当前等待队列中的所有挂起请求都已交付之后，将稍后进行新的尝试。
- 漏洞提取器是由2300行python代码实现的。使用Beautiful Soup Python库[5]解析漏洞报告，提取主要内容。NLTK[29]包用于分割句子、词干、去除停止词等。Aho-Corasick算法[2]是一种加快实体识别阶段的字符串搜索算法。使用scikit-learn[35]库计算实体检查器中的TF-IDF (Term Frequency- inverse Document Frequency)余弦相似度。
- 规则生成器由1500行Python代码实现。我们使用Simhash算法[31]来检测近重复项，并使用Stanford依赖解析器[51]来建立依赖树。

### 5.2 部署
IoTShield有两种部署模式:粗粒度和细粒度。在粗粒度模式下，无论设备类型如何，生成的所有规则都将在IDS系统中使用。所有规则都是用来检查网络流量的。这种模式很容易部署，但可能有一些误报，因为有些规则可能是特定于设备的。此外，在粗粒度模式中，我们建议不要只使用由描述生成的规则。这是因为当忽略设备类型时，仅从描述生成的规则可能会导致一些误报。例如，针对Merit Lilin IP摄像机中“/new/index.htm”文件存在信息泄露漏洞的报告，我们仅通过描述生成一个签名来阻止试图从“/new/index.htm”文件中提取信息的流量。但是，这种情况(检索“/new/index.htm”文件)也可能发生在正常的web服务器中，并导致误报。在细粒度模式中，我们考虑网络环境并为给定的设备类型部署规则。例如，如果本地网络中只有D-link设备，我们只部署保护D-link漏洞的规则。更具体地说，在细粒度模式下，IoTShield首先分析网络流量或主动探测网络，以识别设备类型(如型号和品牌)及其IP地址。这一步可以通过使用被监控网络中的设备列表或使用[47]中提出的设备指纹方法来实现。然后，根据当前网络中的设备类型，进行签名选择过程，选择对应的签名。

## 6.评估



