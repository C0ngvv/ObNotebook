2023 Usenix

# 翻译
## 摘要
随着物联网设备的日益普及，扩展当前的分析技术以匹配成为一项越来越重要的任务。这一挑战的一部分不仅涉及在模拟环境中重新托管这些嵌入式设备的固件，而且还涉及在这样做时发现真正的漏洞。当前最先进的重托管方法必须考虑到仿真设备和物理设备之间的差异，因此通常侧重于提高仿真保真度。然而，这种对保真度的追求忽略了其他潜在的解决方案。

在本文中，我们提出了一种新颖的重托管技术，用户空间单服务重托管，它模拟了用户空间中的单个固件服务。我们研究了数百个固件样本中涉及的重托管过程，以概括一组防止模拟的障碍，并创建干预措施来解决这些障碍。我们的原型Greenhouse自动重新托管了来自9个不同供应商的7,140个固件映像中的2,841个(39.7%)。我们的方法避开了以前重新托管技术遇到的许多挑战，并使我们能够将常见的漏洞发现技术应用于我们的重新托管图像，例如用户空间覆盖引导的模糊测试。使用这些技术，我们在重新托管的固件服务的一个子集上发现了717个n日漏洞和26个零日漏洞。

## 1.引言
物联网(IoT)的数量几乎是人类的2倍:截至2022年，大约有144亿个连接的物联网设备[18]存在于野外，目前估计到2025年总数将达到342亿个[21]。当然，这些设备的安全性并不完美，仅在2022年上半年，就有86家不同供应商的747个漏洞被披露[34]。物联网固件中未被发现、未报告和潜伏的漏洞的实际数量几乎肯定要高得多。

为了发现物联网设备中的潜在漏洞，研究人员希望在物联网设备固件上应用程序分析技术，包括web扫描和覆盖引导模糊测试等动态方法。然而，这种尝试往往因物联网设备的不可访问性而受到限制:购买它们无法扩展，并且可能耗时，过于昂贵，甚至不可能。即使可以物理访问物联网设备，这些设备上的硬件、操作系统和应用程序的刚性通常也会使上述动态分析技术的应用变得非常困难。

解决此问题的常见解决方案是固件重新托管，或简称重新托管，它在强大、灵活的非物联网设备(如个人计算机(pc)和服务器)上模拟物联网软件。重新托管的一个关键挑战是对每个物联网设备特定的特征和功能的高保真仿真。例如，物联网固件通常将数据存储在NVRAM(非易失性随机存取存储器)中，这在大多数x86 pc上不存在，必须由重新托管环境模拟。外围设备也可能带来困难。无线路由器上的软件服务可以使用仅存在于路由器上的天线发送和接收无线电信号，并且天线行为的完全模拟通常需要大量的手工工作。




