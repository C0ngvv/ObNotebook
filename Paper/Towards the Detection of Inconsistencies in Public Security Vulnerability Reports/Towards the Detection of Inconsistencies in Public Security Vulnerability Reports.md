# 翻译
## 摘要
公共漏洞数据库，如通用漏洞和暴露(CVE)和国家漏洞数据库(NVD)，在促进漏洞披露和缓解方面取得了巨大成功。虽然这些数据库积累了大量的数据，但人们对其信息质量和一致性的关注日益增加。

在本文中，我们提出了一种自动化系统VIEM，用于检测完全标准化的NVD数据库与非结构化CVE描述及其引用的漏洞报告之间的不一致信息。VIEM使我们第一次能够大规模地量化信息一致性，并为社区提供了保持CVE/NVD数据库最新的必要工具。VIEM用于从非结构化文本中提取易受攻击的软件名称和版本。我们为基于深度学习的命名实体识别(NER)和关系提取(RE)引入定制设计，使VIEM能够根据句子结构和上下文识别以前未见过的软件名称和版本。实地真值评价表明，系统具有较高的准确率(精密度0.941，召回率0.993)。使用VIEM，我们使用过去20年的78296个CVE id和70569个漏洞报告的大型数据集来检查信息一致性。我们的结果表明，不一致的易受攻击的软件版本非常普遍。只有59.82%的漏洞报告/CVE总结与标准化的NVD条目严格匹配，且不一致程度随着时间的推移而增加。案例研究证实了NVD的错误信息，即夸大或低估了易受攻击的软件版本。

## 1.引言
计算机和网络系统中的安全漏洞对用户、组织和国家构成了严重的威胁。无法匹配的漏洞通常会导致现实世界的攻击，例如WannaCry勒索软件关闭了医院和学校的数十万台机器[20]，以及影响美国一半人口的Equifax数据泄露[21]。

为此，建立了一个强大的社区努力，以便在攻击者利用漏洞之前找到并修补漏洞。Common Vulnerabilities and Exposures (CVE)项目[4]和国家漏洞数据库(National Vulnerability Database, NVD)[11]是其中最具影响力的力量。CVE是一个全球列表/数据库，通过利用“人群的力量”对公开已知的漏洞进行索引。互联网上的任何人(安全供应商、开发人员和研究人员)都可以分享他们在CVE上发现的漏洞。NVD是美国建立的一个更加标准化的数据库政府(即NIST)。NVD接收来自CVE网站的数据馈送，并进行分析，分配常见漏洞严重性评分(common vulnerability severity scores, CVSS)和其他相关元数据[18]。更重要的是，NVD规范了数据格式，使得算法可以直接处理它们的数据[12]。CVE和NVD在指导漏洞缓解方面都发挥着重要作用。迄今为止，已索引超过10万个漏洞，CVE/NVD数据流已与全球数百家安全厂商集成[10]。

漏洞数据库在积累海量数据的同时，其信息质量也日益受到关注[28,42,44]。更具体地说，CVE/NVD上列出的信息可能不完整或过时，这给研究人员重现漏洞带来了挑战[42]。更糟糕的是，某些CVE条目包含错误信息，可能会导致开发和部署补丁的严重延迟。在实践中，由于更新的高成本，工业系统经常长时间使用遗留软件。当一个相关的漏洞被披露时，系统管理员通常会查找漏洞数据库，以确定他们的软件(以及哪个版本)是否需要打补丁。此外，CVE/NVD是安全公司评估客户安全水平的重要信息来源。关于CVE/NVD的错误信息可能导致关键系统未打补丁。

在本文中，我们提出了一种新的系统来自动检测完全标准化的NVD数据库与非结构化CVE描述及其引用的漏洞报告之间的不一致信息。我们的VIEM系统使我们第一次能够大规模地量化信息一致性。我们的研究重点是漏洞软件版本，这是漏洞复制和漏洞修补最重要的信息之一。在构建VIEM的过程中，我们面临三个主要的技术挑战。首先，由于软件名称和版本的高度多样性，很难建立字典或正则表达式[30,48,59]来达到较高的准确率和查全率。其次，漏洞报告和总结的非结构化文本往往包含代码，其独特的写作风格难以被传统的自然语言处理工具处理[22,49,50]。第三，我们需要提取“易受攻击”的软件名称及其版本，并有效地排除分散注意力的项目(即，非易受攻击的版本)。

我们的系统。为了应对这些挑战，我们构建了带有命名实体识别(NER)模型和关系提取(RE)模型的VIEM(漏洞信息提取模型的简称)。目标是从句子结构中学习模式和指示符，以识别易受攻击的软件名称/版本。使用“上下文”信息，我们的模型可以捕获以前未见过的软件名称，并且通常适用于不同的漏洞类型。更具体地说，NER模型是一个循环深度神经网络[36,56]，它可以精确定位相关实体。它利用单词和字符嵌入对文本进行编码，然后利用序列到序列的双向GRU(门控循环单元)来定位易受攻击软件的名称和版本。训练RE模型分析提取实体之间的关系，将易受攻击的软件名称及其版本配对在一起。最后，为了推广我们的模型来处理不同类型的漏洞，我们引入了一个迁移学习步骤来减少手工注释的工作量。

评估和测量。我们从CVE和NVD数据库以及5个非常受欢迎的漏洞报告网站中收集了大量数据。该数据集涵盖了过去20年中所有13个漏洞类别的78,296个CVE id和70,569个漏洞报告。为了评估，我们手动标注了5193个CVE id样本作为基本事实。结果表明，该系统具有较高的准确率，精密度为0.941，召回率为0.993。此外，我们的模型可推广到所有13个漏洞类别。

为了在实践中检测不一致性，我们将VIEM应用于整个数据集。我们使用NVD作为标准(因为它是信息流的最后一跳)，并检查NVD条目与CVE条目/外部来源之间的不一致性。我们有一些重要的发现。首先，不一致的程度非常高。只有59.82%的外部报告/CVE摘要存在与标准化NVD条目完全相同的漏洞软件版本。对于NVD条目来说，“夸大”或“低估”易受攻击的版本几乎同样常见。其次，我们测量了NVD与其他来源之间的一致性水平，发现不一致性水平在过去20年中有所增加(但自2016年以来开始下降)。最后，我们选取一小部分信息高度不一致的CVE id，手工验证漏洞(包括185个软件版本)。我们确认了官方NVD/CVE条目和/或外部报告错误地包括非漏洞版本和遗漏真正漏洞版本的真实案例。这些信息可能会影响依赖NVD/CVE做出关键决策的系统。

应用程序。检测信息不一致是更新过时条目和减少NVD和CVE数据库中的错误的第一步。以前没有工具可以从非结构化报告中自动提取易受攻击的软件名称和版本。VIEM的一个关键贡献是能够持续监控不同的漏洞报告网站，并定期从CVE/NVD条目中生成“diff”。这可以以各种方式使社区受益。对于CVE/NVD的员工，当发现现有漏洞的新漏洞版本时，VIEM可以通知他们(加快测试和条目更新)。对于安全公司来说，VIEM可以帮助确定客户软件的潜在漏洞版本，从而推动更主动的测试和修补。对于软件用户和系统管理员，“diff”将帮助他们在软件更新方面做出更明智的决定。为了方便未来的研究和应用开发，我们发布了我们的标记数据集和VIEM的源代码。

总之，我们的论文做出了三个关键贡献。
•首先，我们设计并开发了一种新的系统VIEM，从非结构化漏洞报告中提取漏洞软件名称和版本。
•其次，使用大型真实数据集，我们表明我们的系统非常准确，并且可以很好地概括不同的漏洞类型。
•第三，通过应用VIEM，我们首次对CVE和NVD的信息一致性进行了大规模测量。生成的“diff”有助于推动更主动的漏洞测试和信息管理。

## 2.背景与挑战
我们首先介绍安全漏洞报告的背景，并描述我们工作中的技术挑战。

### 2.1 漏洞报告
CVE。当人们发现一个新的漏洞时，他们可以从CVE编号机构(CNAs)请求一个唯一的CVE- id编号[5]。MITRE公司是编辑和主要CNA[19]。然后，CNA将对漏洞进行研究，以确定细节，并检查该漏洞之前是否已被报告。如果该漏洞确实是新的，则分配一个CVE ID，并通过CVE列表公开发布相应的漏洞信息[4,9]。

CVE列表[4]由MITRE作为一个网站维护，CVE团队在该网站上发布报告的每个漏洞的摘要。如[8]所述，CVE团队在编写CVE总结时，会对(公开的)第三方漏洞报告进行分析，并在其描述中包含受影响软件的名称、存在漏洞的软件版本、漏洞类型、利用漏洞的条件/要求等详细信息。

除了摘要之外，每个CVE条目还包含一个外部引用列表。外部引用是指向第三方技术报告或博客/论坛帖子的链接，这些链接为CVE团队制作官方漏洞描述提供了所需的信息[1]。CVE上的信息可以帮助软件供应商和系统管理员精确定位易受攻击软件的版本，评估其风险级别，并执行相应的修复。

NVD。NVD (National Vulnerability Database，国家漏洞数据库)由不同于CVE的组织(即NIST)维护[3]。NVD的构建与CVE列表完全同步。目标是CVE的任何更新都将立即出现在NVD中。当新的CVE ID出现在CVE列表中后，NIST NVD团队将首先进行分析，添加严重性评分等增强信息，然后再创建NVD条目[18]。

与CVE相比，NVD提供了两个额外的特性。首先，NVD数据条目是结构化的。NIST NVD团队将非结构化的CVE信息转换为结构化的JSON或XML，并根据CWE (Common Weakness Enumeration Specification)对漏洞软件名称、版本等信息字段进行格式化和标准化[12]。其次，数据条目不断更新。在初始漏洞报告后，NVD中的信息可能会(手动)更新。例如，随着时间的推移，NIST员工或外部人员可能会发现新的易受攻击的软件版本，并将其添加到现有的NVD条目中[17]。

### 2.2 技术挑战
CVE和NVD数据库主要由人工维护，这导致了许多重要的问题。首先，鉴于一个漏洞可能会在许多不同的地方被报告和讨论，CVE/NVD数据库中的信息(例如易受攻击的软件名称及其版本)是否完整?其次，考虑到社区不断努力研究报告的漏洞，当前手动方法保持CVE/NVD条目最新的有效性如何?

我们的目标是彻底了解外部漏洞报告网站与CVE/NVD数据条目之间的不一致。根据[6]的统计，CVE列表已经归档了超过10万个不同的CVE(尽管某些CVE id被合并或撤销)。每个CVE ID也有5 ~ 30个外部第三方报告。手工提取这些信息是不可行的。主要的挑战是从非结构化报告中自动准确地提取相关信息项。

许多现有的NLP工具旨在从文本中提取相关信息(例如，[22,49,50,53])。然而，漏洞报告的独特特征带来了巨大的挑战，使得现有技术不足。(1)以前未见过的软件出现:CVE列表经常引入新的易受攻击的软件，使得很难使用预定义的字典来识别所有易受攻击软件的名称。因此，基于字典的方法不适合这个问题(例如[30,48])。(2)报告是非结构化的:大多数CVE摘要和漏洞报告都是非结构化的，因此简单的基于正则表达式的技术(例如，[28,59])几乎不起作用。无利益实体普遍存在:漏洞报告通常包含有关软件的易受攻击和非易受攻击版本的信息(参见图1a)。我们的目标是提取“易受攻击”的软件名称和版本，同时排除与非易受攻击软件相关的信息项。依赖于预定义规则的技术在这里几乎不起作用(例如，[28,55,59])。(3)存在多个感兴趣的实体:报告中提到的易受攻击的软件通常涉及多个实体(见图1b)，这些实体之间的关系由报告的上下文决定。这一要求消除了缺乏处理多个实体能力的技术(例如，[28,32,59])。(4)漏洞类型多样:CVE涵盖了多种漏洞类型，每种漏洞类型在描述中都有自己的特点。因此，我们不能简单地使用为某些漏洞类型设计的技术。例如，[59]使用的工具是专门针对内核内存损坏漏洞设计的。我们对我们的真实数据集进行了测试，并没有得到令人满意的结果(召回率低于40%)。

## 3.VIEM的设计
为了应对上述挑战，我们通过组合和定制一套最先进的自然语言处理(NLP)技术，开发了一个自动化工具VIEM。在本节中，我们将简要描述VIEM的设计，并讨论我们设计背后的原因。然后，我们详细阐述了VIEM采用的NLP技术。

### 3.1 概述
为了精确定位和配对我们感兴趣的实体，我们设计了VIEM来完成三个单独的任务。

命名实体识别模型。首先，VIEM利用最先进的命名实体识别(NER)模型[36,56]来识别我们感兴趣的实体，即易受攻击软件的名称和版本、易受攻击组件的名称和版本以及易受攻击软件所依赖的底层软件系统的名称和版本(见图1b)。

![](images/Pasted%20image%2020230703172621.png)

这种设计背后的原因是双重的。首先，NER模型根据输入文本的结构和语义精确定位实体，这为我们提供了追踪训练数据中从未观察到的软件名称的能力。其次，NER模型可以学习和区分与易受攻击和非易受攻击软件版本相关的上下文，这自然允许我们消除软件的非易受攻击版本，并只确定我们感兴趣的实体。

关系提取模型。有了提取出来的实体，VIEM的下一个任务是对已识别的实体进行相应的配对。如图2所示，软件名称和版本共同出现在报告中是很常见的。因此，一种本能的反应是将软件名称和版本放在一起，然后将其视为易受攻击的软件和版本对。然而，这种直截了当的方法并不适合我们的问题。如图1c所示，易受攻击的软件名称并不与所有易受攻击的版本紧密相连。仅仅采用上述方法，我们可能不可避免地会错过易受攻击软件的版本。

![](images/Pasted%20image%2020230703172812.png)

为了解决这个问题，VIEM首先检查版本和软件名称之间的所有可能组合。然后，它利用关系提取(RE)模型[38,62]来确定最可能的组合，并将它们视为正确的实体对。这种设计背后的基本原理如下。RE模型的原始设计不是为了在实体之间找到正确的对。相反，它负责确定一对实体的属性。例如，假设一个RE模型被训练为为一对实体分配以下三个属性之一——“出生在”、“受雇于”和“资本”。给定文本“Steve Jobs出生在加州，是Apple的CEO”中的两对实体P1 =(“Steve Jobs”，“Apple”)和P2 =(“Steve Jobs”，“California”)。，则RE模型会将“受雇于”属性分配给P1，将“出生于”属性分配给P2。

在我们的模型中，每个可能的版本和软件组合都可以被视为一对单独的实体。VIEM利用关系抽取模型的思想，赋予每对属性，表示对应实体之间关系的真实性。然后取对应的属性作为真配对。以图2中的情况为例，有2个软件(Microsoft VBScript和Internet Explorer)和2个版本范围(5.7和5.8以及9到11)表示的4个实体。它们可以以4种不同的方式组合。通过将组合视为4对不同的实体，我们可以使用RE模型为每个组合分配二进制属性。假设所分配的二进制属性表示对应的实体对是否应该分组为软件及其脆弱版本，VIEM可以将属性分配作为确定实体对的指标。应该注意的是，我们以公共平台枚举(CPE)格式表示配对实体[2]。例如:cpe:/a:google:chrome:3.0.193.2:beta ，其中google表示厂商，chrome表示产品，3.0.193.2表示版本号，beta表示软件更新。

转移学习。回想一下，我们需要跨各种漏洞类型度量漏洞报告。如§2.2所述，不同漏洞类型的报告不一定共享相同的数据分布。因此，使用单一的机器学习模型来处理所有的漏洞报告是不可行的，除非我们能够构建并手动标注一个涵盖所有漏洞的大型训练数据集。不幸的是，没有这样的标记数据集可用，并且标记大型数据集需要大量的人力。为了解决这个问题，VIEM采用了迁移学习的策略，利用一个主要类别的漏洞报告学习上述NER和RE模型，然后将其能力转移到其他漏洞类别中。通过这种方式，我们可以减少数据标记的工作量，使VIEM对任意类型的漏洞报告都有效。关于迁移学习的更多细节将在§5中讨论。

### 3.2 命名实体识别模型
我们首先从文本中提取命名实体(易受攻击的软件名称和版本)。我们基于最近的NER模型开发了我们的系统[36,56]。在此基础上，我们集成了一个地名词典，以提高其提取脆弱软件名称的准确性。在高层次上，NER模型首先使用单词和字符嵌入的连接将文本序列编码为单词向量序列。这种嵌入过程是必要的，因为深度神经网络不能直接处理文本。然后以单词向量序列作为输入，该模型使用双向递归神经网络预测序列中每个单词的标签。下面，我们介绍一下关键的技术细节。

对于单词和字符嵌入，NER模型首先使用标准的单词嵌入方法[40]将每个单词编码为向量表示。然后，它利用双向门控循环联合(Bi-GRU)网络在字符级执行文本编码。如图3所示，NER模型将这两个嵌入连接为单个向量序列，然后将其作为另一个Bi-GRU网络的输入。

与前面提到的用于文本嵌入的Bi-GRU网络不同，第二个Bi-GRU网络负责为单词分配标签。回想一下，我们的任务是确定我们感兴趣的与易受攻击软件有关的实体。因此，我们使用Bi-GRU网络来精确定位与此信息相关的单词。更具体地说，我们训练这个Bi-GRU网络为每个单词分配以下标签之一—（1）SV(软件版本)，（2）SN(软件名称)和（3）O(其他)-指示该单词的属性。需要注意的是，我们将脆弱软件、脆弱组件和脆弱软件所依赖的底层软件赋予了相同的SN标签。这是因为该工作测量与漏洞相关的所有软件的版本不一致性2。

考虑到NER模型可能无法完美地追踪到漏洞软件的名称，我们进一步构建了一个地名词典(即由[10]中提到的81551个软件组成的词典)来提高NER模型的识别性能。具体来说，我们设计了一种启发式方法来纠正NER模型未能识别或错误跟踪的信息。首先，我们对每个漏洞报告执行字典查找。然后，如果NER模型已经识别出至少一个字典单词作为软件名称，我们将该报告中的字典单词标记为软件名称。这样，我们就可以纠正一些标识错误的标签。例如，在图2中，假设NER模型将SN标签分配给word Microsoft VBScript和Explorer，表示与漏洞相关的软件。通过词典查找，我们找到了地名词典中的Internet Explorer软件。由于地名表表明Internet和Explorer都没有单独作为软件名称出现过，而且它们与字典中的Internet Explorer最接近，因此我们扩展了我们的标签，用SN标签标记整个字典中的Internet Explorer，并将其视为单个软件。

### 3.3 关系提取模型
关系提取模型最初用于提取两个实体之间的关系[41]。在过去的十年中，研究人员提出了各种技术方法来建立高精度和计算效率高的RE模型。在所有提出的技术中，分层注意神经网络[57]在许多自然语言处理任务中表现出更好的性能。对于我们的系统，我们修改现有的分层注意力神经网络来配对提取的实体(即配对易受攻击的软件名称及其版本)。更具体地说，我们在RE模型中实现了一个新的词级和句子级的组合注意网络，以提高性能。下面，我们简要介绍这个模型，并讨论如何将其应用于我们的问题。关于RE模型的更多细节，读者可以参考这些研究论文[38,57,62]。

如图2所示，RE模型通过三个步骤确定软件名称和版本之间的正确关系。第一步，对软件名称和版本信息的出现次数进行编码，然后生成一组位置嵌入，表示当前单词到同一句子中两个命名实体(即软件名称和版本)的相对距离[38]。具体来说，RE模型首先对上述NER模型生成的实体标签序列进行索引。然后，遍历所有可能组合的软件名称和版本，并根据实体标签的索引使用one-hot编码对组合进行编码。随着one-hot编码的完成，RE模型进一步采用词嵌入方法将one-hot编码转换为两个单独的向量，表示位置的嵌入(见图2)。

在第二步中，与NER模型类似，RE模型使用相同的技术对文本进行编码，并将文本序列转换为向量序列。然后，在单词序列向量的后面，RE模型分别附加每组位置嵌入。例如，在图2中，NER模型确定了两个软件名称和两个版本，它们形成了四种不同的组合(软件名称和版本配对的所有可能方式)。对于每个组合，RE模型将位置嵌入向量附加到单词嵌入向量上，以形成执行分类的最后一步的输入。在本例中，产生四个向量作为输入，每个向量表示一个可能的软件名称-版本对。

在最后一步中，RE模型将每个向量序列作为基于注意力的神经网络的输入，并输出一个指示序列新表示的向量。然后，如图2所示，RE模型将输出向量作为另一个注意网络的输入，通过该网络，RE模型预测哪个名称版本配对最有可能捕获软件名称与其对应版本之间的关系。继续图2中的示例。seq 1和4与一个正输出相关联，这表示Microsoft VBScript 5.7和5.8以及Internet Explorer 9到11的合法配对关系。

## 4.数据集
## 5.评估
### 5.1 评估NER和RE模型
### 5.2 评估迁移学习
## 6.测量信息不一致性
### 6.1 测量方法
### 6.2 地面真值测量
### 6.3大规模经验测量
## 7.案例分析
## 8.讨论
## 9.相关工作
## 10.结论
本文设计并开发了一个自动化工具VIEM，用于大规模测量结构化NVD数据库与非结构化CVE摘要和外部漏洞报告之间的信息一致性。我们的结果表明，不一致的信息是非常普遍的。深入的案例研究证实，NVD/CVE数据库和第三方报告要么遗漏了真正易受攻击的软件版本，要么错误地包含了非易受攻击的版本。错误的信息可能会使易受攻击的软件无法修补，或者增加安全分析师进行风险评估的人工工作量。我们认为，社区有必要系统地纠正漏洞报告中不准确的说法。
