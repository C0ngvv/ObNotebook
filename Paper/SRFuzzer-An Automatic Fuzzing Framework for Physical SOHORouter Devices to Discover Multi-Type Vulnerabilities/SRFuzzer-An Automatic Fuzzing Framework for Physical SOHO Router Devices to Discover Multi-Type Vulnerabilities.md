# SRFuzzer: An Automatic Fuzzing Framework for Physical SOHO Router Devices to Discover Multi-Type Vulnerabilities
![](images/Pasted%20image%2020231010083547.png)
2019 ACSAC

# 翻译
## 摘要
SOHO (small office/home office)路由器为终端设备接入Internet提供服务，在网络空间中扮演着重要的角色。不幸的是，这些路由器普遍存在安全漏洞，特别是在web服务器模块中，极大地危害了最终用户。为了发现这些漏洞，对SOHO路由器的web服务器模块进行模糊测试是最流行的解决方案。然而，由于缺乏输入规范、缺乏路由器内部运行状态、缺乏测试环境恢复机制等原因，其有效性受到限制。此外，模糊测试通常只报告内存损坏漏洞，而无法发现其他漏洞，例如基于web的漏洞。

在本文中，我们提出了一个解决方案SRFuzzer来解决这些问题。它是一个完全自动化的模糊测试框架，用于测试物理SOHO设备。它利用KEY-VALUE数据模型和CONF-READ通信模型两种输入语义模型，连续有效地生成测试用例，并通过电源管理自动恢复测试环境。它还协调多种突变规则和多种监控机制，触发多种类型的漏洞。据我们所知，这是SOHO路由器的第一个全流程全自动模糊测试框架。我们在5家厂商的10台流行路由器上运行了SRFuzzer。总共发现了208个独特的异常行为，其中97个已被确认为零日漏洞。实验结果表明，SRFuzzer在发现的漏洞类型和数量方面优于最先进的解决方案。

关键字：模糊测试，IoT，自动化漏洞检测，数据不一致

## 1.引言
越来越多的终端设备，如笔记本电脑、平板电脑、智能手机、智能家居设备和可穿戴设备，被用于社交生活。它们通常通过小型办公室和家庭办公室(SOHO)路由器连接到互联网。SOHO路由器将终端用户与外部互联网隔离开来[15]，处理终端用户的全部流量，处于突出地位。SOHO路由器的安全性比以往任何时候都更加重要。

不幸的是，SOHO路由器普遍存在安全漏洞[4]，[29]。根据最近的一份报告[6]，83%的流行路由器包含易受攻击的代码。这些漏洞是攻击者利用的主要目标之一。2018年，Cisco Talos发现针对Linksys、MikroTik、NETGEAR和TP-Link网络设备的恶意软件VPNFilter，这些设备都是SOHO路由器，在至少54个国家感染了至少50万台设备[5]。此外，领先的漏洞获取平台Zerodium[3]在2018年增加了对路由器的需求。因此，发现SOHO路由器的漏洞就显得尤为重要。

SOHO路由器的典型架构如图1的右侧所示。SOHO路由器作为网络设备，为接入它的终端设备提供路由等网络服务。更重要的是，由于缺乏用户界面(例如键盘、视频、鼠标)，它还利用web服务进行管理和配置。这些web服务由一些广泛使用的协议提供，例如超文本传输协议(HTTP)。本文将这些协议称为管理协议。

![](images/Pasted%20image%2020231010090004.png)

典型的管理协议是通过在原始设备中嵌入web服务器(后端)来实现的。通常，不同路由器中的web服务器是由设备供应商定制的，因此更容易受到攻击。最近的研究[12]，[15]，[11]表明，大多数被识别的SOHO路由器漏洞都与web服务有关，例如PHP服务器端脚本中的命令注入漏洞和处理移动应用程序web请求时的内存破坏漏洞。因此，本文也着重于发现SOHO路由器web服务器的漏洞

模糊测试(即模糊测试)被认为是一种发现漏洞的强大技术。然而，除了基于应用程序的模糊测试框架IoTFuzzer[11]外，对SOHO路由器web服务器的模糊测试(FWSR)研究很少。该方法借助可控制设备的移动APP程序逻辑，生成有意义的测试用例，触发设备bug。虽然它部分解决了FWSR的问题，但总的来说，FWSR仍然具有挑战性。

**挑战1:模糊专用系统**

SOHO路由器作为嵌入式设备，其功能是专用的，不容易扩展。因此，在测试过程中无法直接获取设备内部的运行状态，在测试过程中使设备卡住，也很难恢复其正常运行状态。这使得FWSR难以持续有效地进行。虽然基于仿真的模糊测试是一种很有前途的获取内部执行信息来指导模糊测试的方法，但它在全系统模式下对各种路由器的仿真受到限制。(见第6节)

**挑战2:分析输入语义**

web服务器的输入遵循标准协议，如超文本传输协议(HyperText Transfer Protocol, HTTP)，但其内部编码交换信息的数据在路由器之间格式各异。如果不调查内部数据和信息交换过程的格式，FWSR在代码覆盖方面是无效的。


