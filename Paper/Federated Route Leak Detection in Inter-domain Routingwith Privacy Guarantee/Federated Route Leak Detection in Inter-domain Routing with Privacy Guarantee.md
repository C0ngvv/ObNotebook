# 翻译

## 摘要

在跨域网络中，路由泄漏会导致Internet流量中断，并造成大规模的网络中断。为了准确检测路由泄漏，需要共享AS业务关系信息。但是，ase之间的业务关系信息是保密的。ase通常不愿意将这些信息透露给其他ase，尤其是它们的竞争对手。在本文中，我们提出了一种名为FL-RLD的方法，通过使用基于区块链的联邦学习框架来检测路由泄漏，同时维护ase之间业务关系的隐私，其中ase可以协作训练全局检测模型，而无需直接披露其特定的业务关系。为了缓解路由泄漏中缺乏真实验证数据的问题，FL-RLD提供了一种通过标记本地路由策略的AS三元组来进行自我验证的方案。我们评估了多种数据集下的FL-RLD，包括不平衡数据集和平衡数据集，并研究了不同拓扑下FL-RLD的不同部署策略。结果表明，无论数据集是均衡的还是不均衡的，FL-RLD检测路由泄漏的性能都优于单个AS检测。此外，结果表明，选择具有最多对等体的as来首次部署FL-RLD，在检测路由泄漏方面比选择具有最多提供者和客户的as带来更大的好处。

关键字：BGP安全，路由泄漏检测，联邦学习

## 1.引言

BGP (Border Gateway Protocol)是域间网络中用于自治系统(ASes)之间交换路由信息的协议。在BGP中，每个自治系统根据自己的路由策略选择最佳路由，并将选择的路由发布给邻居。与域内网络中的最短路径路由策略不同，域间网络中的路由策略更为复杂，因为它考虑了AS之间的业务关系，其中业务关系根据AS的经济因素可以分为两种类型:c2p (customer-to-provider)和p2p (peer-to-peer)。

域间路由策略在许多研究中得到了广泛的研究，如[2,9,11]。他们的分析表明，最常采用的政策是无谷规则（valley-free rule）[23]。在无谷规则中，从提供商或对等体学到的路由不应该导出到其他提供商或对等体。然而，由于错误配置和恶意攻击，路由公告可能会在违反双方商定的路由策略的情况下传播，这种情况被定义为路由泄漏[8,44]。

路由泄漏可以通过重定向流量导致重大中断，并带来遇到中间人攻击的风险[13]。例如，2015年3月12日，印度一家宽带提供商(AS17488)错误地向其提供商AS9498公布了300多个谷歌前缀，导致其用户无法访问谷歌的许多服务[28]。另一起事件发生在2021年2月11日，墨西哥的AS28548向其邻国泄露了2000多个前缀，影响了全球约80个国家[39]。由于严重的路由泄漏报告越来越多，路由泄漏检测变得越来越重要。

由于AS业务关系的保密性，检测路由泄漏是相当具有挑战性的。每个自治系统只知道自己和邻居之间的关系，但由于隐私问题，它不知道其他自治系统的确切关系。为了检测路由泄漏，一些研究[16,17,27,37]侧重于推断AS业务关系。然而，他们的推理技术在部分关键环节上仍然存在错误[17]。根据[35]的结果，在推断对等关系时，推理的精度可能会下降1425%。[5,8,12]等研究没有很好地考虑AS关系的隐私性，要求部署者直接披露AS关系信息，使得部署难以进行。

路由泄漏检测的另一个挑战是缺乏地面真值验证数据。只有少数破坏性路由泄漏事件得到了验证和报告。与客户感知服务(如多媒体服务)无关或不会导致严重中断的路由泄漏很难被发现和验证。例如，S. Abd等人[1]表明，在2006年至2018年期间，只有13起路由泄漏事件得到了验证。地面真值验证数据的缺乏使得传统机器学习技术等流行技术难以用于路由泄漏检测，因为它们通常需要大量具有高精度标签的训练数据来学习路由泄漏的重要特征。

联邦学习是一种分布式机器学习方法，它允许参与者协作训练模型，而无需将本地训练数据传输到中央服务器。每个参与者都可以使用他们的本地数据来训练一个本地模型。联邦学习不是对参与者的局部训练数据进行聚合，而是对参与者的局部模型更新进行聚合，可以保护参与者的数据隐私。然而，传统的联邦学习方法需要第三方服务器来聚合模型更新，这很容易出现单点故障。为了避免这个问题，提出了基于区块链的联邦学习框架[14,26,29,38]，该框架是去中心化的，将区块链的优势(例如区块链上的数据是不可变和可追溯的)与联邦学习的隐私保护技术相结合。

在本文中，我们提出了一种使用基于区块链的联邦学习框架进行路由泄漏检测的方法，即FL-RLD(基于区块链的路由泄漏检测联邦学习)。由于有大量的研究集中在解决区块链技术的安全性和效率[24]，我们主要考虑框架中联邦路由泄漏检测部分的设计。如前所述，一个自治系统具有有限的As业务关系信息，而路由泄漏检测则需要尽可能多的关系信息。通过使用联邦学习，AI可以通过共享模型更新而不是直接与其他人共享业务关系来协作训练模型以识别路由泄漏。此外，为了加强关系信息的隐私保护，我们建议用AS三元组代替业务关系来训练模型。通过使用本地路由策略将AS三元组标记为恶意或常规，我们的方法为路由泄漏中缺乏真实验证数据提供了解决方案。

在该方法中，首先，AS参与者使用已知的路由策略生成本地训练数据。本地训练数据由AS三元组和表示它们是否恶意的标签组成。然后，每个AS参与者使用其本地训练数据来训练本地模型，并通过区块链网络与其他参与者交换本地模型更新。在参与者的每一轮全局通信中，每个参与者将收集其他参与者的所有本地模型更新并将这些更新进行汇总。聚合的全局更新在区块链共识期间由参与者验证。在全局训练完成后，最终的全局模型更新存储在区块链中。AS参与者可以从区块链中检索全局模型更新，并利用它进行进一步的路由泄漏检测。

本文的贡献总结如下:
- 我们考虑了路由泄漏检测问题，并提出了一种通过AS三元组共享路由策略信息的隐私保护方法，而不是直接共享AS之间的业务关系。
- 我们定制了一个基于区块链的联邦学习框架，以学习域间网络中的路由策略，并协同训练一个模型来准确检测路由泄漏。
- 我们在不同的数据集上评估了所提出的方法，并分析了该方法在不同拓扑下的不同部署策略。结果表明，该方法可以提高单个自治系统检测路由泄漏的性能。结果还表明，部署具有最多对等体的as比部署具有最多提供者或客户的as更有助于检测路由泄漏。

本文的其余部分组织如下。第2节概述了路由泄漏的定义和检测路由泄漏的相关工作。在第3节中，我们介绍了路由泄漏检测问题和提出的解决方案。第4节介绍了所进行的实验和结果分析。第五部分是本文的结论。

## 2.背景及相关工作
在本节中，我们将概述路由泄漏的定义和检测路由泄漏的相关工作。

### 2.1 路由泄露
RFC 7908[44]中定义的路由泄漏分为六种类型。类型1:多宿主AS(有多个提供者)将从一个提供者学到的路由泄露给另一个上游提供者。类型2:AS将从一个对等体学到的路由泄露给另一个对等体。类型3:一个自治系统将从它的提供者学到的路由泄露给它的对等体。类型4:自治系统将从对等体学到的路由泄露给它的提供者。类型5:多归属自治系统将从一个上游ISP学到的路由作为源路由发布到另一个上游ISP。类型6:自治系统将其内部路由泄露给它的提供者或对等体。

Type 5和Type 6泄漏与起源前缀劫持更相关，可以通过路由起源验证(ROV)技术检测，如资源公钥基础设施(RPKI)[22]。RPKI可以构建一个可信任的存储库，用于验证前缀和原始ASN的所有权证书。类型1、类型2、类型3和类型4泄漏主要按ASes业务关系分组。图1展示了这四种类型的路由泄漏的简单示例，其中P是宣布路由。在本文中，我们主要关注类型1到类型4泄漏的检测。

![](images/Pasted%20image%2020230611105304.png)

### 2.2 路由泄露检测




# 参考资料
[什么是BGP - 华为 (huawei.com)](https://support.huawei.com/enterprise/zh/doc/EDOC1100280707)

[关于BGP安全那些事儿 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/434629393)

[BGP劫持原理及如何防御 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/568323332)

