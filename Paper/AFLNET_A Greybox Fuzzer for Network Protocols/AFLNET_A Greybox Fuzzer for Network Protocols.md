# AFLNET: A Greybox Fuzzer for Network Protocols


# 翻译
## 摘要
服务器模糊测试很困难。与简单的命令行工具不同，服务器具有巨大的状态空间，只有使用定义良好的输入消息序列才能有效地遍历该状态空间。有效的序列在协议中指定。在本文中，我们提出了AFLNET，这是第一个用于协议实现的灰盒模糊器。与现有的协议模糊器不同，AFLNET采用突变方法并使用状态反馈来指导模糊过程。AFLNET以服务器和实际客户端之间记录的消息交换语料库作为种子，不需要协议规范或消息语法。AFLNET充当客户机，重播发送到服务器的原始消息序列的变体，并保留那些有效地增加代码或状态空间覆盖的变体。为了标识由消息序列执行的服务器状态，AFLNET使用服务器的响应代码。从这个反馈中，AFLNET识别状态空间中的渐进区域，并系统地转向这些区域。用AFLNET对两种流行的协议实现进行的案例研究表明，与最先进的技术相比，AFLNET的性能有了实质性的提升。AFLNET发现了两个新的CVE，它们被归类为临界(CVSS得分为Critical 9.8)。

## 1.引言
在协议实现中发现安全缺陷是至关重要的。协议由面向Internet的服务器使用，以有效可靠的方式相互通信或与客户端通信，协议指定确切的可以在两个或多个在线方之间交换的消息的序列和结构。然而，这种从世界任何地方与服务器通信的能力为远程代码执行攻击提供了充足的机会。攻击者甚至不需要对机器进行物理访问，例如，著名的“心脏出血”漏洞是OpenSSL中的一个安全漏洞，它是SSL/TLS协议的一种实现，承诺安全通信。

然而，发现协议实现中的漏洞也很困难。最先进的模糊测试方法存在一些挑战，如基于覆盖率的灰盒模糊(CGF)[1]，[2]和有状态黑盒模糊(SBF)[3]，[4]。首先，服务器是有状态的和消息驱动的。它从客户端获取一系列消息(又称请求)，处理这些消息并发送适当的响应。然而，实现的协议可能不完全对应于指定的协议。其次，服务器的响应依赖于当前消息和由早期消息控制的当前内部服务器状态。同时，普通的CGF fuzzers(如AFL及其扩展[5]-[7])既不知道服务器状态信息，也不知道要发送的消息的所需结构或顺序。这些CGF fuzzers主要设计用于测试无状态程序(例如，文件处理程序)，这些程序为当前输入产生输出，其中没有维护或考虑内部状态。

开发人员只有使用当前CGF方法来模糊协议实现的变通解决方案。他们需要编写测试harness来对被测服务器(SUT)的特定程序状态进行单元测试[2]，或者将消息序列连接到文件中，并将它们作为种子来执行正常的突变文件模糊测试[1]。这两种方法都有一些缺点。虽然单元测试在某些特定的程序状态下是有效的，但它可能无法彻底测试几个程序状态之间的交互/转换。此外，编写新的测试工具来维护正确的程序状态并避免误报通常需要大量的工作。重要的是，它不适用于端到端模糊测试，以测试源代码可能不可用的整个服务器。



