
GDBDebug代码：
```python
from pwn import *
import time
import re

class GDBDebug:
    def __init__(self, command):
        self.proc = process(command)
        time.sleep(0.8)
        self.shellFlag = self.proc.recv().split(b'\n')[-1]
        print("Have started proc and get the shell flag :", self.shellFlag.decode())
        self.firstSend = True
        self.getHexNumPattern = r'(0x[0-9a-fA-F]+)'
        self.getStrPattern =  r'\"(.*?)\"'
    
    def sendCmd(self, byte_data):
        if self.firstSend:
            self.proc.sendline(byte_data)
            self.firstSend = False
        else:
            self.proc.sendlineafter(self.shellFlag, byte_data)
    
    def recvAll(self):
        return self.proc.recv()
    
    def recvline(self):
        return self.proc.recvline()
    
    def getWDataByAddr(self, addr):
        if type(addr) is str:
            addr = addr.encode()
        elif isinstance(addr, int):
            addr = hex(addr).encode()
        self.proc.sendlineafter(self.shellFlag, b"x/wx " + addr)
        res = self.proc.recvline()
        # b'\x1b[34m0xffffd024\x1b[m:\t0x56557008\n'
        data = re.findall(self.getHexNumPattern, res.decode())
        if len(data) < 2:
            return None
        return int(data[1], 16)
    
    def getStrByAddr(self, addr):
        if type(addr) is str:
            addr = addr.encode()
        elif isinstance(addr, int):
            addr = hex(addr).encode()
        self.proc.sendlineafter(self.shellFlag, b"x/s " + addr)
        res = self.proc.recvline()
        # b'\x1b[34m0x56557008\x1b[m:\t"hello world!"\n'
        data = re.findall(self.getStrPattern, res.decode())
        if not data:
            print("can't get string value")
            return None
        return data[0]
    
    def getReg(self, reg):
        if type(reg) is str:
            reg = reg.encode()
        self.proc.sendlineafter(self.shellFlag, b"info registers " + reg)
        res = self.proc.recvline()
        reg_value = re.findall(self.getHexNumPattern, res.decode())
        if not reg_value:
            return None
        return int(reg_value[0], 16)
```

test：
```python
cmd = ["gdb", "-q", "./test"]
gdb = GDBDebug(cmd)
gdb.sendCmd(b'b *0x5655624c')
gdb.sendCmd(b"r")

# get second param 
a2_addr = gdb.getWDataByAddr("$esp+4")
print("the second param addr is:", hex(a2_addr))

# get param2 string value
str_str = gdb.getStrByAddr(a2_addr)
print("get str is:", str_str)
print("length is:", len(str_str))

# get first param 
a1_addr = gdb.getWDataByAddr("$esp")
print("the second param addr is:", hex(a1_addr))

# get register eip
eip = gdb.getReg('eip')
print("eip value is:", hex(eip))

# get register ebp
ebp = gdb.getReg('ebp')
print("ebp value is:", hex(ebp))

print("the distance between ebp and a1 is :", ebp - a1_addr)
```

原始代码：
```python
p = process(["gdb", "-q", "./test"])
time.sleep(0.8)

shellFlag = p.recv().split(b'\n')[-1]
print(shellFlag.decode())

p.sendline(b'b *0x5655624c')

p.sendlineafter(shellFlag, b"r")

# get second param address
p.sendlineafter(shellFlag, b"x/wx $esp+4")
res = p.recvline()
# b'\x1b[34m0xffffd024\x1b[m:\t0x56557008\n'
getHexNumPattern = r'(0x[0-9a-fA-F]+)'
addr = re.findall(getHexNumPattern, res.decode())
str_addr = int(addr[1], 16)
print(addr)
# ['0xffffd024', '0x56557008']
print(hex(str_addr))
# 0x56557008

# get string value
p.sendlineafter(shellFlag, ("x/s {}".format(hex(str_addr))).encode())
res = p.recvline()
# b'\x1b[34m0x56557008\x1b[m:\t"hello world!"\n'
print(res.decode())

getStrPattern =  r'\"(.*?)\"'
match = re.findall(getStrPattern, res.decode())
# ['hello world!']
if not match:
    print("can't get string value")
    exit(0)
str_str = match[0]
print(str_str)
print("string's length is : ",len(str_str))

# get register eip
p.sendlineafter(shellFlag, b"info registers $eip")
res = p.recvline()
show_eip = re.findall(getHexNumPattern, res.decode())
eip_value = int(show_eip[0], 16)
print(hex(eip_value))

# get first param addr
p.sendlineafter(shellFlag, b"x/wx $esp")
res = p.recvline()
# b'\x1b[34m0xffffd024\x1b[m:\t0x56557008\n'
getHexNumPattern = r'(0x[0-9a-fA-F]+)'
addr = re.findall(getHexNumPattern, res.decode())
a1_addr = int(addr[1], 16)
print(addr)
# ['0xffffd024', '0x56557008']
print("the first param's addr: ", hex(a1_addr))
# 0x56557008

# get ebp value
p.sendlineafter(shellFlag, b"info registers $ebp")
res = p.recvline()
show_eip = re.findall(getHexNumPattern, res.decode())
ebp_value = int(show_eip[0], 16)
print("ebp value is : ", hex(ebp_value))

print(gdb.recvAll().decode())
```