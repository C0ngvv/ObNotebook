---
title: 
date: 2024/01/05
categories: 
tags:
---

# 解析函数分析
saveParentControlInfo函数
请求
```python
import requests
from pwn import *

url = "http://192.168.1.1/goform/saveParentControlInfo"
cookie = {"Cookie": "password=1234"}
data = {"deviceId":"dev1", "enable":"1", "time":"2023-12-2 09:30:12", "urls":"https://www.baidu.comaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaabbbb"}
ret = requests.get(url=url, cookies=cookie, data=data)
print(ret.text)
```

遇到第一个sub_2A5C8
```c
src = (char *)sub_2A5C8((int)a1, (int)"deviceId", (int)&dword_C3050);
```

```
$r0     : 0x000ef5f0  ->  0x000ef6f8  ->  'host'
$r1     : 0x000c32a4  ->  'deviceId'
$r2     : 0x000c3050  ->  0x00000000
$r11/$fp: 0xfffef2cc  ->  0x00015ce8 <websFormHandler+0x150>  ->  0xe3a03001
$sp/$r13: 0xfffeeec0  ->  0x00000000
$pc/$r15: 0x00073144 <saveParentControlInfo+0xf8>  ->  0xebfedd1f
```
执行完
```
$r0     : 0x000f1b70  ->  'dev1'
```
返回的R0并不是最初request写入的内存区域。
```
pwndbg> x/256c 0xf1b70-0x128
0xf1a48:	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'
0xf1a50:	0 '\000'	0 '\000'	0 '\000'	0 '\000'	17 '\021'	1 '\001'	0 '\000'	0 '\000'
0xf1a58:	0 '\000'	1 '\001'	0 '\000'	0 '\000'	0 '\000'	64 '@'	18 '\022'	-120 '\210'
0xf1a60:	100 'd'	101 'e'	118 'v'	105 'i'	99 'c'	101 'e'	73 'I'	100 'd'
0xf1a68:	0 '\000'	100 'd'	101 'e'	118 'v'	49 '1'	0 '\000'	101 'e'	110 'n'
0xf1a70:	97 'a'	98 'b'	108 'l'	101 'e'	0 '\000'	49 '1'	0 '\000'	116 't'
0xf1a78:	105 'i'	109 'm'	101 'e'	0 '\000'	50 '2'	48 '0'	50 '2'	51 '3'
0xf1a80:	45 '-'	49 '1'	50 '2'	45 '-'	50 '2'	32 ' '	48 '0'	57 '9'
0xf1a88:	58 ':'	51 '3'	48 '0'	58 ':'	49 '1'	50 '2'	0 '\000'	65 'A'
0xf1a90:	49 '1'	50 '2'	0 '\000'	117 'u'	114 'r'	108 'l'	115 's'	0 '\000'
0xf1a98:	104 'h'	116 't'	116 't'	112 'p'	115 's'	58 ':'	47 '/'	47 '/'
0xf1aa0:	119 'w'	119 'w'	119 'w'	46 '.'	98 'b'	97 'a'	105 'i'	100 'd'
0xf1aa8:	117 'u'	46 '.'	99 'c'	111 'o'	109 'm'	97 'a'	97 'a'	97 'a'
0xf1ab0:	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'
0xf1ab8:	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'
0xf1ac0:	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'
0xf1ac8:	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'
0xf1ad0:	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'
0xf1ad8:	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'
0xf1ae0:	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'
0xf1ae8:	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'	97 'a'
0xf1af0:	98 'b'	98 'b'	98 'b'	98 'b'	0 '\000'	97 'a'	98 'b'	98 'b'
0xf1af8:	98 'b'	98 'b'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'
0xf1b00:	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'
0xf1b08:	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'
0xf1b10:	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'
0xf1b18:	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'
0xf1b20:	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'
0xf1b28:	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'
0xf1b30:	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'
0xf1b38:	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'
0xf1b40:	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'	0 '\000'
```

```
gef> vmmap
[ Legend:  Code | Heap | Stack | Writable | ReadOnly | None | RWX ]
Start      End        Size       Offset     Perm Path
0x00008000 0x000ca000 0x000c2000 0x00000000 rw- <explored>  <-  $r1, $r8, $r9, $lr, $pc
0x000d2000 0x000f3000 0x00021000 0x00000000 rw- <explored>  <-  $r0, $r3, $r4, $r5, $r12
0xff5d5000 0xff63a000 0x00065000 0x00000000 r-x /lib/libc.so.0
0xff7e0000 0xff7e1000 0x00001000 0x00000000 rw- <explored>
0xff7f0000 0xffff0000 0x00800000 0x00000000 rw- [stack]  <-  $r7, $r10, $r11, $sp
```

获取time参数
```
$r0     : 0x000f0700  ->  0x000ef6f8  ->  'host'
$r1     : 0x000c3088  ->  'time'
$r2     : 0x000c3050  ->  0x00000000
$r11/$fp: 0xfffef2cc  ->  0x00015ce8 <websFormHandler+0x150>  ->  0xe3a03001
$sp/$r13: 0xfffeeec0  ->  0x00000000
$pc/$r15: 0x0007318c <saveParentControlInfo+0x140>  ->  0xebfedd0d
```

执行完
```
$r0     : 0x000f1c90  ->  '2023-12-2 09:30:12'
```







## 参考链接



